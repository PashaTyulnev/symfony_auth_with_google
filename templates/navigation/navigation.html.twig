{# 1. Definiere die aktuelle Route (Best Practice) #}
{% set current_route = app.request.attributes.get('_route') %}

{# 2. Definiere die Klassen-Sets mit elegantem Stil #}
{% set default_classes = 'group flex items-center space-x-3 px-5 py-3.5 rounded-2xl text-gray-600 dark:text-gray-400 hover:bg-gray-100/80 dark:hover:bg-gray-700/50 transition-all duration-200 relative overflow-hidden' %}
{% set active_classes = 'group flex items-center space-x-3 px-5 py-3.5 rounded-2xl bg-gradient-to-r from-slate-100 to-gray-100 dark:from-gray-700/50 dark:to-gray-700/30 text-slate-900 dark:text-white font-medium shadow-sm' %}

<aside class="w-72 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border-r border-gray-200/50 dark:border-gray-700/50 flex flex-col h-full" data-controller="menu">

    {# Header mit Logo #}
    <div class="p-7 pb-6">
        <div class="flex items-center space-x-4">
            <div class="relative">
                <div class="w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-900 dark:from-white dark:to-gray-200 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-105 transition-transform duration-300">
                    {{ ux_icon('lucide:shield', { class: 'text-white dark:text-slate-900 w-6 h-6' }) }}
                </div>
                <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900"></div>
            </div>
            <div>
                <h2 class="text-xl font-light text-gray-900 dark:text-white tracking-tight">SecureTime</h2>
                <p class="text-xs font-light text-gray-500 dark:text-gray-400 mt-0.5">DWD • Objektsicherheit</p>
            </div>
        </div>
    </div>

    {# Navigation mit elegantem Scrollbereich #}
    <nav class="flex-1 overflow-y-auto px-5 pb-5 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent">
        <ul class="space-y-2">

            {% include 'navigation/navigation_element.html.twig' with {'route' : 'app_dashboard', 'icon' : 'lucide:layout-dashboard', 'title' : 'Dashboard'} %}

            {# Einsatzplanung #}
            <li>
                <a href="#" class="{{ default_classes }}">
                    <span class="relative z-10 flex items-center space-x-3 flex-1">
                        {{ ux_icon('lucide:calendar-check', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Einsatzplanung</span>
                    </span>
                    <span class="ml-auto bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs px-2.5 py-1 rounded-full font-medium shadow-sm">3</span>
                </a>
            </li>


            {% set target_route = 'app_company' %}
            <li>
                <a href="{{ path(target_route) }}" class="{% if current_route == target_route %}{{ active_classes }}{% else %}{{ default_classes }}{% endif %}">
                    <span class="relative z-10 flex items-center space-x-3">
                        {{ ux_icon('lucide:lock', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Auftraggeber</span>
                    </span>
                    {% if current_route == target_route %}
                        <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-slate-600 to-slate-800 dark:from-white dark:to-gray-300 rounded-r-full"></div>
                    {% endif %}
                </a>
            </li>

            {# Objekte #}
            {% set target_route = 'app_facility' %}
            <li>
                <a href="{{ path(target_route) }}" class="{% if current_route == target_route %}{{ active_classes }}{% else %}{{ default_classes }}{% endif %}">
                    <span class="relative z-10 flex items-center space-x-3">
                        {{ ux_icon('lucide:building-2', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Objekte</span>
                    </span>
                </a>
            </li>

            {% include 'navigation/navigation_element.html.twig' with {'route' : 'app_employees', 'icon' : 'lucide:users', 'title' : 'Mitarbeiter'} %}
            {% include 'navigation/navigation_element.html.twig' with {'route' : 'app_contacts', 'icon' : 'lucide:contact', 'title' : 'Kontakte'} %}

{#            {% include 'navigation/navigationElement.html.twig' with {'route' : 'app_employees', 'icon' : 'lucide:clock', 'title' : 'Zeiterfassung'} %}#}

            {# Zeiterfassung #}
            <li>
                <a href="#" class="{{ default_classes }}">
                    <span class="relative z-10 flex items-center space-x-3">
                        {{ ux_icon('lucide:clock', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Zeiterfassung</span>
                    </span>
                </a>
            </li>
        </ul>

        {# Eleganter Divider #}
        <div class="my-6 relative">
            <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t border-gray-200/50 dark:border-gray-700/50"></div>
            </div>
        </div>

        <ul class="space-y-2">
            {# Berichte #}
            <li>
                <a href="#" class="{{ default_classes }}">
                    <span class="relative z-10 flex items-center space-x-3">
                        {{ ux_icon('lucide:file-text', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Berichte</span>
                    </span>
                </a>
            </li>

            {# Einstellungen #}
            {% set target_route = 'app_settings' %}
            <li>
                <a href="{{ path(target_route) }}" class="{% if current_route == target_route %}{{ active_classes }}{% else %}{{ default_classes }}{% endif %}">
                    <span class="relative z-10 flex items-center space-x-3">
                        {{ ux_icon('lucide:settings', { class: 'w-5 h-5 transition-colors duration-200' }) }}
                        <span>Einstellungen</span>
                    </span>
                    {% if current_route == target_route %}
                        <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-slate-600 to-slate-800 dark:from-white dark:to-gray-300 rounded-r-full"></div>
                    {% endif %}
                </a>
            </li>
        </ul>
    </nav>

    {# Dark Mode Toggle mit elegantem Design #}
    <div class="px-5 py-4 border-t border-gray-200/50 dark:border-gray-700/50">
        <button data-action="click->menu#toggleDarkMode"
                class="w-full flex items-center justify-between px-5 py-3 rounded-2xl bg-gray-100/50 dark:bg-gray-800/50 hover:bg-gray-200/70 dark:hover:bg-gray-700/70 transition-all duration-200 group">
            <div class="flex items-center space-x-3">
                <div data-menu-target="darkModeTrigger" class="flex items-center">
                    {{ ux_icon('lucide:moon', { class: 'w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-200 transition-colors' }) }}
                </div>
                <div data-menu-target="lightModeTrigger" class="hidden">
                    {{ ux_icon('lucide:sun', { class: 'w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-200 transition-colors' }) }}
                </div>
                <span class="text-sm font-light text-gray-600 dark:text-gray-400 group-hover:text-gray-800 dark:group-hover:text-gray-200">
                    <span data-menu-target="darkModeText">Dunkler Modus</span>
                    <span data-menu-target="lightModeText" class="hidden">Heller Modus</span>
                </span>
            </div>
            <div class="w-11 h-6 bg-gray-300 dark:bg-gray-600 rounded-full relative transition-colors duration-200 group-hover:bg-gray-400 dark:group-hover:bg-gray-500">
                <div class="absolute top-0.5 left-0.5 dark:left-[1.375rem] w-5 h-5 bg-white rounded-full shadow-md transition-all duration-200"></div>
            </div>
        </button>
    </div>

    {# Benutzer-Profil mit elegantem Design #}
    <div class="p-5 border-t border-gray-200/50 dark:border-gray-700/50 bg-gray-50/50 dark:bg-gray-800/30">
        <div class="flex items-center space-x-3">
            <div class="relative">
                <div class="w-11 h-11 bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700 rounded-full flex items-center justify-center shadow-inner">
                    {{ ux_icon('lucide:user', { class: 'w-5 h-5 text-gray-600 dark:text-gray-300' }) }}
                </div>
                <div class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-gray-50 dark:border-gray-800"></div>
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                    {{ app.user.username }}
                </p>
                <p class="text-xs text-gray-500 dark:text-gray-400 truncate">
                    {{ app.user.email }}
                </p>
            </div>
            <a href="{{ path('app_logout') }}"
               class="p-2 rounded-xl hover:bg-gray-200/70 dark:hover:bg-gray-700/70 transition-all duration-200 group">
                {{ ux_icon('lucide:log-out', {
                    class: 'w-5 h-5 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors'
                }) }}
            </a>
        </div>
    </div>
</aside>

{# Zusätzliche Styles für Scrollbar #}
<style>
    /* Custom Scrollbar */
    .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
    }

    .scrollbar-thin::-webkit-scrollbar-track {
        background: transparent;
    }

    .scrollbar-thin::-webkit-scrollbar-thumb {
        border-radius: 3px;
        background-color: rgba(156, 163, 175, 0.5);
    }

    .dark .scrollbar-thin::-webkit-scrollbar-thumb {
        background-color: rgba(75, 85, 99, 0.5);
    }

    .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background-color: rgba(156, 163, 175, 0.7);
    }

    .dark .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background-color: rgba(75, 85, 99, 0.7);
    }

    /* Smooth hover effects */
    nav a {
        position: relative;
    }



</style>
